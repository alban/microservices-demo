.PHONY: test coverage

dev: clean image container networks logs

deps:
	@npm install

image:
	@docker build -t dev/frontend .

container:
	@docker run -it -d --name devfrontend -P -e NODE_ENV=development -e PORT=8080 -p 8080:8080 dev/frontend

networks:
	@for network in secure internal external; do docker network connect dockersingle_$$network devfrontend; done

clean:
	@if [ $$(docker ps -a -q -f name=devfrontend | wc -l) -ge 1 ]; then docker rm -f devfrontend; fi

test:
	@$$(npm bin)/istanbul cover $$(npm bin)/_mocha -- -R nyan

test-w:
	@$$(npm bin)/mocha -R nyan -w

coverage:
	@open coverage/lcov-report/index.html

browser:
	@open $$(docker-machine ip):8080

logs:
	@docker logs -f devfrontend
